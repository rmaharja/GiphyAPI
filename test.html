$(document).ready(function() {

     //Make the api call

      function encodeQueryData(data)
      {
         var ret = [];
         for (var d in data)
            ret.push(encodeURIComponent(d) + "=" + encodeURIComponent(data[d]));
         return ret.join("&");
      }

     //xmlHttp request used instead of ajax call does similar function

      function httpGetAsync(theUrl, callback)
      {
          var xmlHttp = new XMLHttpRequest();
          xmlHttp.onreadystatechange = function() { 
              if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                  callback(xmlHttp.responseText);
          }
          xmlHttp.open("GET", theUrl, true); // true for asynchronous 
          xmlHttp.send(null);
      }

     //Retrieve and display gifs

      function getGif(query) {
          
        console.log(query);
        query = query.replace(' ', '+');
        var params = { 'api_key': apikey, 'q': query};
        params = encodeQueryData(params);

        // api from https://github.com/Giphy/GiphyAPI#search-endpoint 
          $.ajax({
              url:"http://api.giphy.com/v1/gifs/search?" + params,
              method: 'GET'
          })
          .done(function(data){
              var gifs = JSON.parse(data);
              var firstgif = gifs.data[0].images.fixed_width.url;
              $("#image").html("<img src='" + firstgif + "'>");
                $("#image").append("<input type='button' value='"+query+"'/>")
              console.log(gifs.data);
          });
        httpGetAsync('http://api.giphy.com/v1/gifs/search?' + params, function(data) {
          var gifs = JSON.parse(data);
            for (var i=0; i<data.length; i++){
              var firstgif = gifs.data[i].images.fixed_width.url;
              $("#image").append("<img src='" + firstgif + "'>");
              console.log(gifs.data);
            }
        
        });
      }

      $("#submitButton").on("click", function() {
        var query = $("#inputQuery").val();
          $("#buttondiv").append("<input type='button' value='"+query+"'/>");
        getGif(query);
      });
    })
    
    </script>
</head>
<body>
    <div id="query">
        <input type="text" id="inputQuery"><input type="button" id="submitButton" value="submit">
    </div>
    <div id="buttondiv"><input type='button' value='first one'/></div>
    <div id="image">
    </div>
</body>
</html>