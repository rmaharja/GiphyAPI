<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Giphy</title>
  <!-- Bootstrap CSS CDN  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" />

  <!-- Font Awesome CSS Icons (For cool glyphicons) -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />

  <!-- Local CSS -->
  <link rel="stylesheet" type="text/css" href="main.css">

  <!-- JQuery-->
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>

  <!-- Local JS File -->
</head>

<body>
  <div class="container">
  <nav>
    <div class="row" id="header">
      <div class="col 12 col-md-6">
        <a class="navbar-brand">
          <h3>Welcome to Your Giphtastic Page</h3>
        </a>
      </div>
    </div>
        <form id="giphForm">
      <div class="col 12 col-md-6">
        <label for="">Search and Add your own Giphs Below!</label>
        <input type="text" id="searchText">
        <input id="submitButton" type="submit" value="Add Giph">
      </div>

  </nav>


  <div class="row" >
    <div class="col 12 col-md-12">
      <div id="buttonSection">
      <!-- Buttons go here -->
    </div>
    </div>
  </div>

  <div class="row" id="giphSection">
    <div class="col 12 col-md-12">
      <h5>Click the Pics to see the Giphs ^_^</h5>
      <!-- Giphs go here -->
    </div>

  </div>

</div>
<script type="text/javascript">

var reactionsArray = ["wtf", "wow", "nope", "see ya", "OMG", "hahaha", "mindblown"];

function displayButtons() {

  // makes sure that the button does not repeat.
  $("#buttonSection").empty();
  //for loop to loop thru every giph

  for (var i = 0; i < reactionsArray.length; i++) {
    // Creating a variable that is a button
    var newButtons = $("<button>");
    // Adding class to the newGiphBtn for easier selection of buttons.
    newButtons.addClass("giphBtn");
    // Adding a data-attribute to add extra info
    newButtons.attr("data-reaction", reactionsArray[i]);
    // Add the text to the button based on the selected array.
    newButtons.text(reactionsArray[i]);
    $("#buttonSection").append(newButtons);


  }

}

//Creating new buttons
$("#submitButton").on("click", function (event) {

    event.preventDefault();
    //Getting user input value from the textbox
    var reaction = $("#searchText").val().replace(' ', '+');
    // console.log("submit:");
    // console.log(reaction);
    //Getting the movies  based on the into reactionArray
    reactionsArray.push(reaction);

    // Create new Buttons
    displayButtons();
  });


function displayGiph() {
  var reaction = $(this).attr("data-reaction");

  var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + reaction + "&api_key=cZi2yavHeMNM9vuaa4CGLRG6fYd9fNOj&limit=10";
  // console.log(queryURL);

  $.ajax({
    url: queryURL,
    method: "GET"

  })
    .then(function (response){
      console.log(response);

      console.log(queryURL);

      $("#giphSection").empty() //clears previous giphs


      for (var i = 0; i < response.data.length; i++) {

        // Creating div/class so that the new giphs can go in it.
        var giphDiv = $("<div>").addClass("giphClass");

        //Retreiving Rating and adding it to a <p> tag
        var rated = response.data[i].rating;
        var pRating = $("<p>").text("Giph Rating:" + rated);
        giphDiv.append(pRating);

        //Retrieving Giph images (still, src and animated)
        var srcURL = response.data[i].images.fixed_height_still.url;
        var stillURL = response.data[i].images.fixed_height_still.url;
        var animatedURL = response.data[i].images.fixed_height.url;

        var giphImage = $("<img>").attr("src", srcURL);
        giphImage.addClass("giphImages");
        //Adding attr to the image and setting data state. 
        giphImage.attr("data-still", stillURL);
        giphImage.attr("data-animate", animatedURL);
        giphImage.attr("data-state", "still");
        //Adding the gif to the div
        giphDiv.append(giphImage);
        // Adding gifDiv to the HTML 
        $("#giphSection").append(giphDiv);
      }
    });
}
//Making function do some work (calling them)

displayButtons();
// createNewButtons();

$(document).on("click", ".giphBtn", displayGiph);

//pausing and unpausing the images.
$(document).on('click', '.giphImages', function (event) {
  event.preventDefault();
  var state = $(this).attr("data-state");
  if (state === "still") {
    $(this).attr("src", $(this).attr("data-animate"));
    $(this).attr("data-state", "animate");
  } else {
    $(this).attr("src", $(this).attr("data-still"));
    $(this).attr("data-state", "still");
  }

});

//On c
</script>
</body>

</html>